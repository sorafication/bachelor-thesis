define(["librastandardlib/dom-utils/breakpoint-helper"],function(breakpointHelper){"use strict";var defaults={resizeEvent:"resize.sticky-subnav",clickEvent:"click.sticky-subnav",subnavSelector:".lb-sticky-subnav",titleSelector:".lb-sticky-subnav-title",linksSelector:".lb-sticky-subnav-links",pageContentSelector:".lb-page-with-sticky-subnav",pageHeaderSelector:"#aws-page-header",pageMobileNavSelector:"#aws-nav-mobile",activeClass:"lb-active",linkUnderlineClass:"lb-link-underline",subnavHeightThreshold:50};var StickySubnav=function(elem){this.$elem=$(elem);this.options=$.extend({},defaults,this.$elem.data());this.$links=this.$elem.find(this.options.linksSelector).first();this.$title=this.$elem.find(this.options.titleSelector).first();this.hasV3NavClass=$(this.options.pageHeaderSelector).hasClass("m-page-header");if($(this.options.subnavSelector).height()>this.options.subnavHeightThreshold){this.setPageContentTopMargin()}this.setLinkUnderline();this.setNavView();this.bindResizeEvent()};StickySubnav.prototype={setNavView:function(){if(breakpointHelper.isMidUp()){this.setDefaultView()}else{this.setMobileView()}},setMobileView:function(){this.$title.on(this.options.clickEvent,function(e){e.preventDefault();this.toggleLinks()}.bind(this));this.$links.css("max-height",0)},setDefaultView:function(){this.$title.off(this.options.clickEvent);this.$elem.removeClass(this.options.activeClass);this.$links.css("max-height","none")},toggleLinks:function(){this.$elem.toggleClass(this.options.activeClass);var maxHeight=0;if(this.$elem.hasClass(this.options.activeClass)){maxHeight=this.$links.get(0).scrollHeight+"px"}this.$links.css("max-height",maxHeight)},setPageContentTopMargin:function(){var marginTop=0;if(breakpointHelper.isMidUp()){marginTop=$(this.options.pageHeaderSelector).outerHeight()+"px"}$(this.options.pageContentSelector).css("margin-top",marginTop)},setLinkUnderline:function(){if(breakpointHelper.isMidUp()){this.$elem.toggleClass("lb-link-underline",this.$elem.outerHeight()<=this.options.subnavHeightThreshold)}},bindResizeEvent:function(){var isMobileViewActivated=!breakpointHelper.isMidUp();$(window).on(this.options.resizeEvent,function(){if(breakpointHelper.isMidUp()===isMobileViewActivated){isMobileViewActivated=!isMobileViewActivated;this.setNavView()}if(!this.hasV3NavClass){this.setPageContentTopMargin()}this.setLinkUnderline()}.bind(this))}};Libra.Comp.register({name:"sticky-subnav",initFct:function(elem){new StickySubnav(elem)},initTime:"immediate"});return StickySubnav});